function $(e){"function"==typeof e&&Application.dom_load_event_listeners.push(e)}function isset(e){return"undefined"!=typeof e}function closeCookie(){document.getElementById("cookie-box").style.display="none"}function setCookie(e,t,n){var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var o="expires="+a.toUTCString();document.cookie=e+"="+t+"; "+o}function initPlaylistCheckbox(e){El(e).on("change",function(e){return function(){e.checked?addVideoToPlaylist(e.getAttribute("data-playlist-id"),_VIDEO_ID_):removeVideoFromPlaylist(e.getAttribute("data-playlist-id"),_VIDEO_ID_)}}(e))}function elementInViewport(e){for(var t=e.offsetTop,n=e.offsetLeft,a=e.offsetWidth,o=e.offsetHeight;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t>=window.pageYOffset&&n>=window.pageXOffset&&t+o<=window.pageYOffset+window.innerHeight&&n+a<=window.pageXOffset+window.innerWidth}function BackgroundLoader(e){this.element=El(e),this.src=this.element.getAttribute("data-background"),this.element.style.backgroundImage="url("+this.src+")",this.loadInView="string"==typeof this.element.getAttribute("data-background-load-in-view")?!0:!1,!this.loadInView||elementInViewport(this.element)?this.loadBackground():BackgroundLoader.elementsToCheck.push(this)}function postMessage(){marmottajax.post({url:_webroot_+"posts",json:!0,options:{"post-message-submit":"lol",channel:El("#channel-social-message-submit").getAttribute("data-channel-id"),"post-content":El("#post-content").value}}).then(function(){return function(e){El("#channel-posts").addFirst(Co('<channel-post avatar="${avatar}" channel="${channel}" message="${message}"/>',{avatar:_my_avatar_,channel:_my_pseudo_,message:e.content}))}}(El("#channel-social-message-submit").getAttribute("data-channel-id"))),El("#post-content").value=""}function ChatMessage(){var e=this;this.data="",this.sender="",this.content="",this.messageType="text",this.channel=Chat.channel,this.timestamp=Math.round(+new Date/1e3),this.construct=function(t,n,a){e.sender=t,e.content=n,0==n.lastIndexOf("/",0)&&(e.messageType="command");var o={sender_name:e.sender,content:e.content,messageType:e.messageType,channel:e.channel,timestamp:e.timestamp};"undefined"==typeof a||a.length>0&&(o.sessionId=a),e.data=JSON.stringify(o)},this.parse=function(t){try{var n=JSON.parse(t);e.sender=n.sender_name,e.content=n.content,e.messageType=n.messageType,e.timestamp=n.timestamp}catch(a){alert(a)}}}function initChat(e){Chat.address=e.ip,Chat.port=e.port,Chat.channel=e.channel,Chat.username=e.username?e.username:"Dreamer",Chat.sessionId=e.sessionId,window.onkeypress=keyPress,Chat.start();var t=document.getElementById("messages-panel");t.addEventListener("mouseover",function(){Chat.isHover=!0}),t.addEventListener("mouseout",function(){Chat.isHover=!1}),t.addEventListener("mousewheel",function(e){t.scrollTop+=e.wheelDelta>0||e.detail<0?-30:30})}function sendChatMessage(){if(Chat.connected){var e=document.getElementById("live-chat-input"),t=new ChatMessage;t.construct(Chat.username,e.value,Chat.sessionId),Chat.socket.send(t.data),e.value=""}}function keyPress(e){"undefined"==typeof e&&window.event&&(e=window.event);var t=document.getElementById("live-chat-input");document.activeElement==t&&13==e.keyCode&&sendChatMessage()}function postComment(e,t,n,a){marmottajax.post({url:_webroot_+"comments/",options:{commentSubmit:"lol","comment-content":t,"from-channel":n,"video-id":e,parent:a}}).then(function(e){return function(t){var n=JSON.parse(t);n.channelUrl=e,n.avatar=_my_avatar_,n.plusNumber=0,n.moinsNumber=0,n.date="À l'instant",El("#comments-best").addFirst(Co('<comment data="${data}"/>',{data:n}))}}(n)),El("#textarea-comment").value=""}function setExporterInputValue(){if(!El("#exporter-input"))return!1;var e=El("#exporter-input"),t=El("#exporter-quality"),n=El("#exporter-autoplay"),a=El("#exporter-time-checkbox"),o=El("#exporter-time-input"),i="//dreamvids.fr/embed/video/"+_VIDEO_ID_,r=t.options[t.value].innerHTML||"640x360",l=r.split("x");width=l[0],height=l[1];var s=n.checked||!1;s&&(i+="/autoplay");var c=a.checked||!1;if(c)for(var d=o.value,m=d.split(":").reverse(),u=0;u<m.length;u++)i+=m[u]+"/";e.value='<iframe width="'+width+'" height="'+height+'" src="'+i+'" allowfullscreen frameborder="0"></iframe>'}function playListScroll(e){El("#playlist-videos").scrollLeft+=e}function redirectOverlayUpdate(){var e=document.getElementById("redirect-at-end");e.innerHTML=e.getAttribute("data-message").replace("{time}",Application.redirectOverlayTime)+"<br>";var t=document.createElement("div");t.className="video__redirect-at-end__cancel",t.innerHTML=e.getAttribute("data-cancel-message"),t.onclick=cancelRedirectOverlay,e.appendChild(t)}function cancelRedirectOverlay(){var e=document.getElementById("redirect-at-end");clearInterval(Application.redirectOverlayInterval),Application.redirectOverlayTime=5,Application.redirectOverlay=!1,e.className=e.className.replace("video__redirect-at-end--show","")}function initPlaylistCheckbox(e){El(e).on("change",function(e){return function(){e.checked?addVideoToPlaylist(e.getAttribute("data-playlist-id"),_VIDEO_ID_):removeVideoFromPlaylist(e.getAttribute("data-playlist-id"),_VIDEO_ID_)}}(e))}function elementInViewport(e){for(var t=e.offsetTop,n=e.offsetLeft,a=e.offsetWidth,o=e.offsetHeight;e.offsetParent;)e=e.offsetParent,t+=e.offsetTop,n+=e.offsetLeft;return t>=window.pageYOffset&&n>=window.pageXOffset&&t+o<=window.pageYOffset+window.innerHeight&&n+a<=window.pageXOffset+window.innerWidth}function BackgroundLoader(e){this.element=El(e),this.src=this.element.getAttribute("data-background"),this.element.style.backgroundImage="url("+this.src+")",this.loadInView="string"==typeof this.element.getAttribute("data-background-load-in-view")?!0:!1,!this.loadInView||elementInViewport(this.element)?this.loadBackground():BackgroundLoader.elementsToCheck.push(this)}function postMessage(){marmottajax.post({url:_webroot_+"posts",json:!0,options:{"post-message-submit":"lol",channel:El("#channel-social-message-submit").getAttribute("data-channel-id"),"post-content":El("#post-content").value}}).then(function(){return function(e){El("#channel-posts").addFirst(Co('<channel-post avatar="${avatar}" channel="${channel}" message="${message}"/>',{avatar:_my_avatar_,channel:_my_pseudo_,message:e.content}))}}(El("#channel-social-message-submit").getAttribute("data-channel-id"))),El("#post-content").value=""}function ChatMessage(){var e=this;this.data="",this.sender="",this.content="",this.messageType="text",this.channel=Chat.channel,this.timestamp=Math.round(+new Date/1e3),this.construct=function(t,n,a){e.sender=t,e.content=n,0==n.lastIndexOf("/",0)&&(e.messageType="command");var o={sender_name:e.sender,content:e.content,messageType:e.messageType,channel:e.channel,timestamp:e.timestamp};"undefined"==typeof a||a.length>0&&(o.sessionId=a),e.data=JSON.stringify(o)},this.parse=function(t){try{var n=JSON.parse(t);e.sender=n.sender_name,e.content=n.content,e.messageType=n.messageType,e.timestamp=n.timestamp}catch(a){alert(a)}}}function initChat(e){Chat.address=e.ip,Chat.port=e.port,Chat.channel=e.channel,Chat.username=e.username?e.username:"Dreamer",Chat.sessionId=e.sessionId,window.onkeypress=keyPress,Chat.start();var t=document.getElementById("messages-panel");t.addEventListener("mouseover",function(){Chat.isHover=!0}),t.addEventListener("mouseout",function(){Chat.isHover=!1}),t.addEventListener("mousewheel",function(e){t.scrollTop+=e.wheelDelta>0||e.detail<0?-30:30})}function sendChatMessage(){if(Chat.connected){var e=document.getElementById("live-chat-input"),t=new ChatMessage;t.construct(Chat.username,e.value,Chat.sessionId),Chat.socket.send(t.data),e.value=""}}function keyPress(e){"undefined"==typeof e&&window.event&&(e=window.event);var t=document.getElementById("live-chat-input");document.activeElement==t&&13==e.keyCode&&sendChatMessage()}function postComment(e,t,n,a){marmottajax.post({url:_webroot_+"comments/",options:{commentSubmit:"lol","comment-content":t,"from-channel":n,"video-id":e,parent:a}}).then(function(e){return function(t){var n=JSON.parse(t);n.channelUrl=e,n.avatar=_my_avatar_,n.plusNumber=0,n.moinsNumber=0,n.date="À l'instant",El("#comments-best").addFirst(Co('<comment data="${data}"/>',{data:n}))}}(n)),El("#textarea-comment").value=""}function setExporterInputValue(){if(!El("#exporter-input"))return!1;var e=El("#exporter-input"),t=El("#exporter-quality"),n=El("#exporter-autoplay"),a=El("#exporter-time-checkbox"),o=El("#exporter-time-input"),i="//dreamvids.fr/embed/video/"+_VIDEO_ID_,r=t.options[t.value].innerHTML||"640x360",l=r.split("x");width=l[0],height=l[1];var s=n.checked||!1;s&&(i+="/autoplay");var c=a.checked||!1;if(c)for(var d=o.value,m=d.split(":").reverse(),u=0;u<m.length;u++)i+=m[u]+"/";e.value='<iframe width="'+width+'" height="'+height+'" src="'+i+'" allowfullscreen frameborder="0"></iframe>'}function playListScroll(e){El("#playlist-videos").scrollLeft+=e}function redirectOverlayUpdate(){var e=document.getElementById("redirect-at-end");e.innerHTML=e.getAttribute("data-message").replace("{time}",Application.redirectOverlayTime)+"<br>";var t=document.createElement("div");t.className="video__redirect-at-end__cancel",t.innerHTML=e.getAttribute("data-cancel-message"),t.onclick=cancelRedirectOverlay,e.appendChild(t)}function cancelRedirectOverlay(){var e=document.getElementById("redirect-at-end");clearInterval(Application.redirectOverlayInterval),Application.redirectOverlayTime=5,Application.redirectOverlay=!1,e.className=e.className.replace("video__redirect-at-end--show","")}var Application={name:"DreamVids"};!function(win,doc){function on(element,event,callback,binding){if(!element.length)return"#document-fragment"===element.nodeName?void on(element.childNodes,event,callback,binding):("function"==typeof elAndCoEvents.list[event]?elAndCoEvents.list[event](element,function(){return function(event){"string"==typeof callback?eval(callback):callback(event,binding)}}(callback,binding)):isset(element.addEventListener)?element.addEventListener(event,function(){return function(e){callback(e,binding)}}(callback,binding),!1):element.attachEvent("on"+event,function(){return function(e){callback(e,binding)}}(callback,binding)),element);for(var i=0;i<element.length;i++)on(element[i],event,callback,binding)}function childNodeList(e){for(var t=[],n=0;n<e.childNodes.length;n++)if(t.push(e.childNodes[n]),e.childNodes[n].childNodes)for(var a=childNodeList(e.childNodes[n]),o=0;o<a.length;o++)t.push(a[o]);return t}function isset(e){return"undefined"!=typeof e}var window=win,document=doc;window.ELCO_MAX_COMPONENTS_GENERATED=2048;var elAndCoEvents={list:{}};elAndCoEvents.add=function(e,t){elAndCoEvents.list[e]=t},elAndCoEvents.onClickEventsList=[],elAndCoEvents.add("CLICK",function(e,t){var n=new elAndCoEvents.onClickObject(e,t);elAndCoEvents.onClickEventsList.push(n)}),elAndCoEvents.onClickObject=function(e,t){this.callback=t,this.element=e,this.touchstart=function(e){return function(t){e.moved=!1,e.startX=t.touches[0].clientX,e.startY=t.touches[0].clientY}}(this),this.touchmove=function(e){return function(t){(Math.abs(t.touches[0].clientX-e.startX)>10||Math.abs(t.touches[0].clientY-e.startY)>10)&&(e.moved=!0)}}(this),this.touchend=function(e){return function(t){e.moved||e.callback(t)}}(this),on(this.element,"touchstart",this.touchstart),on(this.element,"touchmove",this.touchmove),on(this.element,"touchend",this.touchend),on(this.element,"touchcancel",this.touchend),on(this.element,"click",function(e,t){"ontouchstart"in window||t.callback(e)},this)};var El=Element=function(e,t){if("undefined"==typeof this.self)var n=Element.create(e,t);else var n=Element.select(e,t);if(n){n.childs=n.childNodes,n.parent=n.parentNode,n.clone=n.cloneNode;for(method in Element.methods)Element.methods.hasOwnProperty(method)&&"undefined"==typeof n[method]&&(n[method]=function(e,t){return function(){return t(e,arguments)}}(n,Element.methods[method]));return n}};Element.methods={},Element.addMethod=function(e,t){"string"==typeof e&&"function"==typeof t?Element.methods[e]=t:console.error("el & co erreur 002\nLes arguments donnés lors de l'ajout d'une méthode aux Elements sont invalides.")},Element.create=function(e,t){var n,a=/[-\w]+/.exec(e)[0];if(n=document.createElement(a),"object"==typeof t)for(attribute in t)t.hasOwnProperty(attribute)&&!n.getAttribute(attribute)&&n.setAttribute(attribute,t[attribute]);var o=e.replace(/#([a-z-_]+)/i,"").replace(/\w+/,"").split(".");if(o.length>1){n.className="";for(var i=1;i<o.length;i++)n.className+=" "+o[i]}var r=/([a-z-_]+)(#([a-z-_]+))/i.exec(e);return r&&(n.id=r[3]),n},Element.select=function(e){var t;return"string"!=typeof e?t=e:"#"==e[0]&&(t=document.getElementById(e.substring(1))),t},Element.addMethod("addClass",function(e,t){return"string"!=typeof t[0]?e:(e.hasClass(name)||(e.className+=" "+t[0]),e)}),Element.addMethod("addFirst",function(e,t){var n=t[0];if(n){if("#document-fragment"===n.nodeName){for(var a=[],o=n.childNodes,i=o.length,r=0;i>r;r++)e.insertBefore(o[0],e.firstChild),a.push(e.childNodes[e.childNodes.length-1]);return a}if(!n.length)return e.insertBefore(n,e.firstChild),El(n);for(var r=0;r<n.length;r++){for(var a=[],i=n.length,r=0;i>r;r++)e.insertBefore(n[0],e.firstChild),a.push(e.childNodes[e.childNodes.length-1]);return a}}}),Element.addMethod("add",function(e,t){var n=t[0];if(n){if("#document-fragment"===n.nodeName){for(var a=[],o=n.childNodes,i=o.length,r=0;i>r;r++)e.appendChild(o[0]),a.push(e.childNodes[e.childNodes.length-1]);return a}if(!n.length)return e.appendChild(n),El(n);for(var r=0;r<n.length;r++){for(var a=[],i=n.length,r=0;i>r;r++)e.appendChild(n[0]),a.push(e.childNodes[e.childNodes.length-1]);return a}}}),Element.addMethod("hasClass",function(e,t){return"string"!=typeof t[0]?e:(" "+e.className+" ").indexOf(" "+t[0]+" ")>-1}),Element.addMethod("offset",function(e){for(var t={x:0,y:0,width:e.clientWidth,height:e.clientHeight};e;)t.x+=e.offsetLeft-(e==document.body?0:e.scrollLeft)+e.clientLeft,t.y+=e.offsetTop-(e==document.body?0:e.scrollTop)+e.clientTop,e=e.offsetParent;return t}),Element.addMethod("on",function(e,t){"object"==typeof t&&"string"==typeof t[0]&&"function"==typeof t[1]&&on(e,t[0],t[1],t[2])}),Element.addMethod("removeClass",function(e,t){return"string"!=typeof t[0]?e:(e.className=(" "+e.className+" ").replace(" "+t[0]+" "," "),e)}),Element.addMethod("toggleClass",function(e,t){return"string"!=typeof t[0]?e:(e.hasClass(t[0])?e.removeClass(t[0]):e.addClass(t[0]),e)});var Co=Component=function(e,t){if("undefined"!=typeof this.self)return Co.generate(e,t);if("object"==typeof e||"string"==typeof e.name){Co.components[e.name]=this,this._mixinsCallbacks={created:[]};for(variable in e)e.hasOwnProperty(variable)&&!isset(this[variable])&&(this[variable]=e[variable]);if(this.mixins instanceof Array)for(var n=0;n<this.mixins.length;n++)if(Co.mixins[this.mixins[n]]){var a=Co.mixins[this.mixins[n]];for(variable in a)a.hasOwnProperty(variable)&&("undefined"!=typeof this._mixinsCallbacks[variable]&&"function"==typeof a[variable]?this._mixinsCallbacks[variable].push(a[variable]):isset(this[variable])||(this[variable]=a[variable]))}}};Co.components={},Component.attributesParser=function(e,t){for(var n={},a=0;a<e.length;a++)if(n[e[a].name]=e[a].value,"string"==typeof e[a].value&&"$"==e[a].value[0]&&t)for(parameter in t)e[a].value==="${"+parameter+"}"&&t.hasOwnProperty(parameter)&&(n[e[a].name]=t[parameter]);return n},Component.prototype.callCallback=function(e,t){for(var n=0;n<this._mixinsCallbacks[e].length;n++)this._mixinsCallbacks[e][n](t);"function"==typeof this[e]&&this[e](t)},Component.prototype.create=function(e){var t=this.render(e),n=childNodeList(t);if(isset(e._CHILDNODES_)&&e._CHILDNODES_.length){for(var a=!1,o=0;o<n.length;o++){var i=n[o];if("_inner_"===i.getAttribute("tag-name")){for(;e._CHILDNODES_.length;)i.parentNode.insertBefore(e._CHILDNODES_[0],i);i.parentNode.removeChild(i),a=!0;break}}if(!a)for(;e._CHILDNODES_.length;)t.appendChild(e._CHILDNODES_[0])}return isset(this.created)&&this.callCallback("created",t),t},Component.generate=function(e,t){if("string"!=typeof e)return document.createElement("div");e=e.replace(/^\s+|\s+$/g,""),e=e.replace(/<([-\w]*)( (.+?))?\/>/g,"<$1$2></$1>"),e=e.replace(/<([-\w]*)( (.+?))?>/g,'<div tag-name="$1"$2>').replace(/<\/(.+?)>/g,"</div>");var n=document.createElement("div");n.innerHTML=e;var a=!1,o=!1;for(componentsCreated=0;!a;){o=!1,ELCO_MAX_COMPONENTS_GENERATED&&componentsCreated>ELCO_MAX_COMPONENTS_GENERATED&&(console.error("el & co erreur 001\nUne boucle de création de components a été détectée.\nLa génération des components a alors été arrêtée."),a=!0);for(var i=childNodeList(n),r=0;r<i.length;r++){var l=i[r],s="";if(l.getAttribute&&(s=l.getAttribute("tag-name")||""),Co.components[s]){var c=Component.attributesParser(l.attributes,t);c._CHILDNODES_=l.childNodes;var d=Co.components[s].create(c);for(attribute in c)c.hasOwnProperty(attribute)&&null===d.getAttribute(attribute)&&"string"==typeof c[attribute]&&d.setAttribute(attribute,c[attribute]);d.removeAttribute("tag-name"),l.parentNode.insertBefore(d,l),l.parentNode.removeChild(l),o=!0,componentsCreated++;break}}o||(a=!0)}return n.childNodes},Component.inner=function(e){var t=document.createElement("div");return t.setAttribute("tag-name","_inner_"),e.appendChild(t),e},Component.mixins={},Component.Mixin=function(e,t){"string"==typeof e&&"object"==typeof t&&(Component.mixins[e]=t)},window.Co=window.Component,window.El=window.Element}(window,document);var marmottajax=function(e){return marmottajax.get(e)};marmottajax.normalize=function(e){return e?"string"==typeof e?{url:e}:e:!1},marmottajax.json=function(e){return(e=marmottajax.normalize(e))?(e.json=!0,new marmottajax.request(e)):void 0},marmottajax.get=function(e){return new marmottajax.request(e)},marmottajax.post=function(e){return(e=marmottajax.normalize(e))?(e.method="POST",new marmottajax.request(e)):void 0},marmottajax.put=function(e){return(e=marmottajax.normalize(e))?(e.method="PUT",new marmottajax.request(e)):void 0},marmottajax["delete"]=function(e){return(e=marmottajax.normalize(e))?(e.method="DELETE",new marmottajax.request(e)):void 0},marmottajax.request=function(e){if(!e)return!1;if("string"==typeof e&&(e={url:e}),"POST"===e.method||"PUT"===e.method||"DELETE"==e.method){var t="?";for(var n in e.options)t+=e.options.hasOwnProperty(n)?"&"+n+"="+e.options[n]:""}else{e.method="GET",e.url+=e.url.indexOf("?")<0?"?":"";for(var n in e.options)e.url+=e.options.hasOwnProperty(n)?"&"+n+"="+e.options[n]:""}this.xhr=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xhr.options=e,this.xhr.callbacks={then:[],error:[]},this.then=function(e){return this.xhr.callbacks.then.push(e),this},this.error=function(e){return this.xhr.callbacks.error.push(e),this},this.xhr.call=function(e,t){for(var n=0;n<this.callbacks[e].length;n++)"function"==typeof this.callbacks[e][n]&&this.callbacks[e][n](t)},this.xhr.returnSuccess=function(e){this.call("then",e)},this.xhr.returnError=function(e){this.call("error",e)},this.xhr.onreadystatechange=function(){if(4===this.readyState&&200==this.status){var e=this.responseText;if(this.options.json)try{e=JSON.parse(e)}catch(t){return this.returnError("invalid json"),!1}this.returnSuccess(e)}else 4===this.readyState&&404==this.status?this.returnError("404"):4===this.readyState&&this.returnError("unknow")},this.xhr.open(e.method,e.url,!0),this.xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xhr.send("undefined"!=typeof t?t:null)},Application.dom_load_event_listeners=[],Application.dom_content_loaded=!1,Application.on_dom_content_loaded=function(){if(!Application.dom_content_loaded){Application.dom_content_loaded=!0;for(var e=0;e<Application.dom_load_event_listeners.length;e++){var t=Application.dom_load_event_listeners[e];"function"==typeof t&&t()}}},El(document).on("DOMContentLoaded",Application.on_dom_content_loaded),El(window).on("load",Application.on_dom_content_loaded),window.onload=function(){Application.on_dom_content_loaded()},window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),$(function(){for(var e=0;e<Application.scripts.length;e++){var t=!1,n=Application.scripts[e];if("*"!==n.pages&&"all"!==n.pages&&n.pages)for(var a=0;a<n.pages.length;a++)n.pages[a]===_currentpage_&&(t=!0);else t=!0;t&&!Application.scripts[e].alreadyCalled&&(Application.scripts[e].alreadyCalled=!0,n.to_call())}}),Application.scripts=[];var Script=function(e){this.pages=e.pages,this.to_call=e.call,Application.scripts.push(this)};new Component({name:"btn",render:function(e){var t="raised"===e.type?"raised":"flat",n=e.color?".btn--"+e.color:"",a=e.outline?".btn--outline-"+e.outline:"",o=e.ripple?".btn--ripple-"+e.ripple:"",i=isset(e.disable)?".disabled":"",r=new Element("div.btn.btn--"+t+n+a+o+i);return i||(r.tabIndex=0),"function"==typeof e.click&&El(r).on("CLICK",e.click,r),e["no-ripple"]||El(r).add(Co('<ripple parent="${parent}"/>',{parent:r})),r}}),new Co({name:"card",render:function(e){var t=isset(e.type)?e.type:"video";if("video"===t){var n=new El("div.card.video"),a=n.add(new El("div.thumbnail"));a.style.backgroundImage="url("+e.thumbnail+")";var o=a.add(new El("div.time"));o.innerHTML=e.duration;var i=a.add(new El("a.overlay"));i.href="watch/"+e["vid-id"];var r=n.add(new El("div.description")),l=r.add(new El("a"));l.href="watch/"+e["vid-id"];var s=l.add(new El("h4"));s.innerHTML=e.title;var c=r.add(new El("div")),d=c.add(new El("div.view"));d.innerHTML=e.views;var m=c.add(new El("a.channel"));m.href="channel/"+e.channel,m.innerHTML=e["channel-name"]}else if("plus"==t){var n=new El("div.card.plus"),u=n.add(new El("a"));u.href="watch/"+e["vid-id"];var a=u.add(new El("div.thumbnail"));a.style.backgroundImage="url("+e.thumbnail+")";var h=u.add(new El("p")),p=h.add(new El("b"));p.innerHTML=e["channel-name"],h.innerHTML+=' a aimé votre vidéo "<b>'+e["vid-name"]+'</b>"';var v=n.add(new El("i"));v.innerHTML=e["relative-time"]}else if("comment"==t){var n=new El("div.card.comment"),u=n.add(new El("a"));u.href="watch/"+e["vid-id"];var h=u.add(new El("p")),p=h.add(new El("b"));p.innerHTML=e["channel-name"],h.innerHTML+=' a commenté votre vidéo "<b>'+e["vid-name"]+'</b>"';var f=u.add(new El("blockquote"));f.innerHTML=e.comment;var v=n.add(new El("i"));v.innerHTML=e["relative-time"]}else if("channel"==t){var n=new El("div.card.channel"),u=n.add(new El("a"));u.href="watch/"+e.channel;var g=u.add(new El("div.avatar"));g.style.backgroundImage="url("+e.avatar+")";var h=u.add(new El("p")),p=h.add(new El("b"));p.innerHTML=e["channel-name"],h.innerHTML+=" s'est abonné à votre chaîne \"<b>"+e["my-channel-name"]+'</b>"';var E=n.add(new El("span.subscribers"));E.innerHTML="<b>"+e.subscribers+"</b> Abonnés";var v=n.add(new El("i"));v.innerHTML=e["relative-time"]}return n.on("CLICK",e.click,n),n}}),new Co({name:"channel-post",render:function(e){var t=new Element("div.channel-post"),n=t.add(new Element("img"));n.src=e.avatar;var a=t.add(new Element("p")),o=a.add(new Element("span.channel-name"));o.innerHTML=e.channel,a.innerHTML+=" a posté un message :";var i=t.add(new Element("div.social-message"));return i.innerHTML=e.message,t}}),new Co({name:"comment",render:function(e){if(e.data){var t=e.data,n=new El("div.comment"),a=n.add(new El("div.comment-head")),o=a.add(new El("div.user")),i=o.add(new El("img"));i.src=_my_avatar_;var r=o.add(new El("a"));r.href="../channel/"+t.channelUrl,r.innerHTML=t.author;var l=a.add(new El("div.date")),s=l.add(new El("p"));s.innerHTML=t.date;var c=n.add(new El("div.comment-text")),d=c.add(new El("p"));d.innerHTML=t.comment;var m=n.add(new El("div.comment-notation")),u=m.add(new El("ul")),h=u.add(new El("li.plus")),p=u.add(new El("li.moins"));return h.id="plus-"+t.id,p.id="moins-"+t.id,h.onclick=function(e){return function(){likeComment(e)}}(t.id),p.onclick=function(e){return function(){dislikeComment(e)}}(t.id),h.innerHTML="+"+t.plusNumber,p.innerHTML="-"+t.moinsNumber,n}}}),new Component({name:"ripple",render:function(e){var t=new Element("div.ripple");if(e.parent){var n="ontouchstart"in window?"touchstart":"mousedown";El(e.parent).on(n,function(e,t){var n=t.ripple,a=t.parent;if(!El(a).hasClass("disabled")){var o=n.add(new El("div.ripple__circle.ripple__circle--animate")),i=El(a).offset(),r=e.changedTouches?e.changedTouches[0].pageX:e.pageX,l=e.changedTouches?e.changedTouches[0].pageY:e.pageY;o.style.left=r-i.x+"px",o.style.top=l-i.y+"px"}},{ripple:t,parent:e.parent})}return t}}),new Script({pages:["watch"],call:function(){if(!El("#add-playlist-icon"))return!1;El("#add-playlist-icon").onclick=function(){var e=El("#video-info-description");e.hasClass("playlist")?(e.removeClass("export"),e.removeClass("playlist")):(e.removeClass("export"),e.className+=" playlist")};var e=El("#playlist-add-form-list").childNodes;for(child in e)e.hasOwnProperty(child)&&"INPUT"===e[child].nodeName&&initPlaylistCheckbox(e[child])}}),BackgroundLoader.elementsToCheck=[],BackgroundLoader.prototype.loadBackground=function(){this.backgroundLoading=!0,this.imgLoader=new Image,this.imgLoader.src=this.src,El(this.imgLoader).on("load",function(e,t){t.addClass("bg-loader-transition"),t.addClass("bg-loaded"),setTimeout(function(e){return function(){e.removeClass("bg-loader-transition")}}(t),400)},this.element)},El(window).on("scroll",function(){for(var e=0,t=BackgroundLoader.elementsToCheck.length;t>e;e++){var n=BackgroundLoader.elementsToCheck[e];elementInViewport(n.element)&&!n.backgroundLoading&&n.loadBackground()}}),new Script({call:function(){var e=document.getElementsByClassName("bg-loader");if(e&&e.length)for(var t=0,n=e.length;n>t;t++)new BackgroundLoader(e[t])}}),new Script({call:function(){}}),new Script({pages:["channel"],call:function(){var e=El("#channel-social-message-submit");e&&(e.onclick=postMessage,El("#post-content").on("keydown",function(e){13===e.keyCode&&e.ctrlKey&&postMessage()}))}}),window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var Screen={pushMessage:function(e){var t=document.getElementById("messages-panel"),n=document.createElement("div");n.className="live-chat__message";var a=document.createElement("span");a.className="live-chat__message__pseudo "+(e.rank?"live-chat__message__pseudo--"+e.rank:"");var o=document.createTextNode(e.sender);a.appendChild(o);var i=document.createElement("p"),r=document.createTextNode(e.content);i.appendChild(r),n.appendChild(a),n.appendChild(i),t.appendChild(n),Chat.scrollDown();var l=32;if(t.childNodes.length>l)for(var s=0;t.childNodes.length>l;)t.removeChild(t.childNodes[s])},pushText:function(e,t){var n=document.getElementById("messages-panel"),a=document.createElement("div");a.className="live-chat__message live-chat__message--"+t;var o=document.createElement("p"),i={error:"Erreur",info:"Information"},r=document.createElement("span");r.className="live-chat__message__pseudo",r.innerHTML=(i[t]||t)+" : "+e,o.appendChild(r),a.appendChild(o),n.appendChild(a),n.scrollTop=n.scrollHeight},clearFirst:function(){var e=document.getElementById("messages-panel");e.removeChild(e.firstChild)}},Chat={connected:!1,socket:null,address:"127.0.0.1",port:8080,channel:"",username:"Dreamer",sessionId:"",scrolling:!1,isHover:!1,scrollSpeed:0,start:function(){this.socket=new WebSocket("ws://"+this.address+":"+this.port+"/"+this.channel),this.socket.onopen=this.onConnect,this.socket.onclose=this.onDisconnect,this.socket.onmessage=this.onMessage,this.socket.onerror=this.onError},onConnect:function(){var e=new ChatMessage;e.construct(Chat.username,"",Chat.sessionId),Chat.socket.send(e.data),Chat.connected=!0,Screen.pushText("Bienvenue !","info")},onMessage:function(e){try{var t=new ChatMessage;t.parse(e.data),Screen.pushMessage(t)}catch(n){Screen.pushText(n.message,"error")}},onDisconnect:function(){Chat.connected=!1,Screen.pushText("Disconnected","info")},onError:function(){Screen.pushText("WebSocket error","error")},scrollDown:function(){Chat.scrolling||Chat.isHover||Chat.scrollInterval()},scrollInterval:function(){var e=document.getElementById("messages-panel");Chat.scrolling=!0,speed=Math.abs(e.scrollTop+e.offsetHeight-e.scrollHeight)/12+1,Chat.scrollSpeed+=Chat.scrollSpeed<speed?speed/5:-speed/8,e.scrollTop+=Chat.isHover?0:Chat.scrollSpeed,e.scrollTop+e.offsetHeight<e.scrollHeight?requestAnimationFrame(Chat.scrollInterval):(Chat.scrollSpeed=0,Chat.scrolling=!1)}},chatAlreadyCalled=!1;new Script({pages:["live"],call:function(){chatAlreadyCalled||(chatAlreadyCalled=!0,initChat(chatLiveOptions))}}),new Script({pages:["watch"],call:function(){return El("#post-comment-button")?void(El("#post-comment-button").onclick=function(){postComment(El("#post-comment-button").getAttribute("data-vid-id"),El("#textarea-comment").value,El("#channel-selector").value,El("#parent-comment").value)}):!1}}),new Script({pages:["watch"],call:function(){return El("#embed-video-icon")?(El("#embed-video-icon").onclick=function(){var e=El("#video-info-description");e.hasClass("export")?(e.removeClass("playlist"),e.removeClass("export")):(e.removeClass("playlist"),e.className+=" export",El("#exporter-input").select())},El("#exporter-quality").onchange=setExporterInputValue,El("#exporter-autoplay").onchange=setExporterInputValue,El("#exporter-time-checkbox").onchange=setExporterInputValue,El("#exporter-time-input").onchange=setExporterInputValue,void setExporterInputValue()):!1}}),new Script({pages:["default","watch"],call:function(){}}),new Script({pages:["watch"],call:function(){if(!document.getElementById("playlist-button-scroll-left"))return!1;var e=El("#playlist-button-scroll-left"),t=El("#playlist-button-scroll-right");e.onclick=function(){playListScroll(-300)},t.onclick=function(){playListScroll(200)}}}),new Script({pages:["watch"],call:function(){var e=document.getElementById("video-tag");return e?(Application.redirectOverlay=!1,void e.addEventListener("ended",function(){if(!Application.redirectOverlay&&(Application.redirectOverlay=!0,"undefined"!=typeof _redirectAtEnd&&""!==_redirectAtEnd)){var e=document.getElementById("redirect-at-end");Application.redirectOverlayTime=5,redirectOverlayUpdate(),e.className.indexOf("video__redirect-at-end--show")<0&&(e.className+=" video__redirect-at-end--show"),Application.redirectOverlayInterval&&(clearInterval(Application.redirectOverlayInterval),Application.redirectOverlayInterval=null),Application.redirectOverlayInterval=setInterval(function(){Application.redirectOverlayTime--,redirectOverlayUpdate(),0===Application.redirectOverlayTime&&(document.location=_redirectAtEnd)},1e3)}},!1)):!1}}),new Script({pages:["watch"],call:function(){return El("#share-video-icon")?void(El("#share-video-icon").onclick=function(){var e=El("#share-video-block"),t=El("#video-info-description");t.hasClass("little")?t.removeClass("little"):t.className+=" little",e.hasClass("show")?e.removeClass("show"):e.className+=" show"}):!1}}),new Script({pages:["watch"],call:function(){if(!El("#add-playlist-icon"))return!1;El("#add-playlist-icon").onclick=function(){var e=El("#video-info-description");e.hasClass("playlist")?(e.removeClass("export"),e.removeClass("playlist")):(e.removeClass("export"),e.className+=" playlist")};var e=El("#playlist-add-form-list").childNodes;for(child in e)e.hasOwnProperty(child)&&"INPUT"===e[child].nodeName&&initPlaylistCheckbox(e[child])}}),BackgroundLoader.elementsToCheck=[],BackgroundLoader.prototype.loadBackground=function(){this.backgroundLoading=!0,this.imgLoader=new Image,this.imgLoader.src=this.src,El(this.imgLoader).on("load",function(e,t){t.addClass("bg-loader-transition"),t.addClass("bg-loaded"),setTimeout(function(e){return function(){e.removeClass("bg-loader-transition")}}(t),400)},this.element)},El(window).on("scroll",function(){for(var e=0,t=BackgroundLoader.elementsToCheck.length;t>e;e++){var n=BackgroundLoader.elementsToCheck[e];
elementInViewport(n.element)&&!n.backgroundLoading&&n.loadBackground()}}),new Script({call:function(){var e=document.getElementsByClassName("bg-loader");if(e&&e.length)for(var t=0,n=e.length;n>t;t++)new BackgroundLoader(e[t])}}),new Script({call:function(){}}),new Script({pages:["channel"],call:function(){var e=El("#channel-social-message-submit");e&&(e.onclick=postMessage,El("#post-content").on("keydown",function(e){13===e.keyCode&&e.ctrlKey&&postMessage()}))}}),window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();var Screen={pushMessage:function(e){var t=document.getElementById("messages-panel"),n=document.createElement("div");n.className="live-chat__message";var a=document.createElement("span");a.className="live-chat__message__pseudo "+(e.rank?"live-chat__message__pseudo--"+e.rank:"");var o=document.createTextNode(e.sender);a.appendChild(o);var i=document.createElement("p"),r=document.createTextNode(e.content);i.appendChild(r),n.appendChild(a),n.appendChild(i),t.appendChild(n),Chat.scrollDown();var l=32;if(t.childNodes.length>l)for(var s=0;t.childNodes.length>l;)t.removeChild(t.childNodes[s])},pushText:function(e,t){var n=document.getElementById("messages-panel"),a=document.createElement("div");a.className="live-chat__message live-chat__message--"+t;var o=document.createElement("p"),i={error:"Erreur",info:"Information"},r=document.createElement("span");r.className="live-chat__message__pseudo",r.innerHTML=(i[t]||t)+" : "+e,o.appendChild(r),a.appendChild(o),n.appendChild(a),n.scrollTop=n.scrollHeight},clearFirst:function(){var e=document.getElementById("messages-panel");e.removeChild(e.firstChild)}},Chat={connected:!1,socket:null,address:"127.0.0.1",port:8080,channel:"",username:"Dreamer",sessionId:"",scrolling:!1,isHover:!1,scrollSpeed:0,start:function(){this.socket=new WebSocket("ws://"+this.address+":"+this.port+"/"+this.channel),this.socket.onopen=this.onConnect,this.socket.onclose=this.onDisconnect,this.socket.onmessage=this.onMessage,this.socket.onerror=this.onError},onConnect:function(){var e=new ChatMessage;e.construct(Chat.username,"",Chat.sessionId),Chat.socket.send(e.data),Chat.connected=!0,Screen.pushText("Bienvenue !","info")},onMessage:function(e){try{var t=new ChatMessage;t.parse(e.data),Screen.pushMessage(t)}catch(n){Screen.pushText(n.message,"error")}},onDisconnect:function(){Chat.connected=!1,Screen.pushText("Disconnected","info")},onError:function(){Screen.pushText("WebSocket error","error")},scrollDown:function(){Chat.scrolling||Chat.isHover||Chat.scrollInterval()},scrollInterval:function(){var e=document.getElementById("messages-panel");Chat.scrolling=!0,speed=Math.abs(e.scrollTop+e.offsetHeight-e.scrollHeight)/12+1,Chat.scrollSpeed+=Chat.scrollSpeed<speed?speed/5:-speed/8,e.scrollTop+=Chat.isHover?0:Chat.scrollSpeed,e.scrollTop+e.offsetHeight<e.scrollHeight?requestAnimationFrame(Chat.scrollInterval):(Chat.scrollSpeed=0,Chat.scrolling=!1)}},chatAlreadyCalled=!1;new Script({pages:["live"],call:function(){chatAlreadyCalled||(chatAlreadyCalled=!0,initChat(chatLiveOptions))}}),new Script({pages:["watch"],call:function(){return El("#post-comment-button")?void(El("#post-comment-button").onclick=function(){postComment(El("#post-comment-button").getAttribute("data-vid-id"),El("#textarea-comment").value,El("#channel-selector").value,El("#parent-comment").value)}):!1}}),new Script({pages:["watch"],call:function(){return El("#embed-video-icon")?(El("#embed-video-icon").onclick=function(){var e=El("#video-info-description");e.hasClass("export")?(e.removeClass("playlist"),e.removeClass("export")):(e.removeClass("playlist"),e.className+=" export",El("#exporter-input").select())},El("#exporter-quality").onchange=setExporterInputValue,El("#exporter-autoplay").onchange=setExporterInputValue,El("#exporter-time-checkbox").onchange=setExporterInputValue,El("#exporter-time-input").onchange=setExporterInputValue,void setExporterInputValue()):!1}}),new Script({pages:["default","watch"],call:function(){}}),new Script({pages:["watch"],call:function(){if(!document.getElementById("playlist-button-scroll-left"))return!1;var e=El("#playlist-button-scroll-left"),t=El("#playlist-button-scroll-right");e.onclick=function(){playListScroll(-300)},t.onclick=function(){playListScroll(200)}}}),new Script({pages:["watch"],call:function(){var e=document.getElementById("video-tag");return e?(Application.redirectOverlay=!1,void e.addEventListener("ended",function(){if(!Application.redirectOverlay&&(Application.redirectOverlay=!0,"undefined"!=typeof _redirectAtEnd&&""!==_redirectAtEnd)){var e=document.getElementById("redirect-at-end");Application.redirectOverlayTime=5,redirectOverlayUpdate(),e.className.indexOf("video__redirect-at-end--show")<0&&(e.className+=" video__redirect-at-end--show"),Application.redirectOverlayInterval&&(clearInterval(Application.redirectOverlayInterval),Application.redirectOverlayInterval=null),Application.redirectOverlayInterval=setInterval(function(){Application.redirectOverlayTime--,redirectOverlayUpdate(),0===Application.redirectOverlayTime&&(document.location=_redirectAtEnd)},1e3)}},!1)):!1}}),new Script({pages:["watch"],call:function(){return El("#share-video-icon")?void(El("#share-video-icon").onclick=function(){var e=El("#share-video-block"),t=El("#video-info-description");t.hasClass("little")?t.removeClass("little"):t.className+=" little",e.hasClass("show")?e.removeClass("show"):e.className+=" show"}):!1}});